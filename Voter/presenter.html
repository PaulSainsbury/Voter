<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="Scripts/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script src="Scripts/knockout-2.1.0.js" type="text/javascript"></script>
    <script src="Scripts/jquery.signalR-0.5.0.min.js" type="text/javascript"></script>
    <script src="Scripts/html5slider.js" type="text/javascript"></script>
    <script src="Scripts/jquery.loadmask.min.js" type="text/javascript"></script>
    <link href="Styles/jquery.loadmask.css" rel="stylesheet" type="text/css" />

    <script src="signalr/hubs" type="text/javascript"></script>

    <script type="text/javascript">
        $(function () {
            function TalkEval() {
                this.init = function () {
                    // Private variables
                    var hub = $.connection.vote;
                    // Private functions
                    function voteValueToString(value, lessValue, zeroValue, moreValue) {
                        if (value < 0) {
                            return lessValue;
                        } else if (value == 0) {
                            return zeroValue;
                        } else {
                            return moreValue;
                        }
                    };

                    function setRange(name, value, maxValue) {
                        maxValue = maxValue || 1;
                        value = value || 0;
                        $("#" + name).attr("min", -maxValue).attr("max", maxValue).val(value);
                    };

                    function getName(prefix, value, low, mid, high) {
                        return prefix + (value > 0 ? high : (value < 0 ? low : mid));
                    };

                    // Setup code and events
                    hub.updateVotes = function (result) {
                        $("body").unmask();
                        if (result.numberOfVotes !== null) {
                            $("#numVotes").html(result.numberOfVotes);
                            setRange("rangeSpeed", result.speed, result.numberOfVotes);
                            setRange("rangePreparation", result.preparation, result.numberOfVotes);
                            setRange("rangeTechValue", result.techValue, result.numberOfVotes);
                            setRange("rangeDemos", result.demos, result.numberOfVotes);

                            $("#lblComments").html(result.comments);
                        }
                    };

                    hub.setValue = function (vote) {
                        $("body").unmask();
                    }

                    $.connection.hub.start();

                    $("#btnReset").click(function () {
                        $("body").mask("Resetting...");
                        hub.resetVotes();
                    });
                }
            };
            var talkEval = new TalkEval();
            talkEval.init();
        });
    </script>

</head>
<body>
    <input type="button" value="Reset" id="btnReset" /> <br />
    Out of <div id="numVotes" style=" display: inline">0</div> votes<br />
    <table>
        <tr>
            <td> Speed : </td>
            <td> Too Slow </td>
            <td> <input id="rangeSpeed" type="range" min="-1" max="1" value="0" /></td>
            <td> Too Fast </td>
        </tr>
        <tr>
            <td> Preparation :</td>
            <td> Not at all</td>
            <td> <input id="rangePreparation" type="range" min="-1" max="1" value="0" /></td>
            <td> Well Prepared</td>
        </tr>
        <tr>
            <td> Tech Value : </td>
            <td> Nothing of Value </td>
            <td> <input id="rangeTechValue" type="range" min="-1" max="1" value="0" /></td>
            <td> Super valuable</td>
        </tr>
        <tr>
            <td> Demos :</td>
            <td> To Few </td>
            <td> <input id="rangeDemos" type="range" min="-1" max="1" value="0" /></td>
            <td> To many </td>
        </tr>
        <tr>
            <td colspan="4">Comments:</td>
        </tr>
        <tr>
            <td colspan="4"><span id="lblComments"></span></td>
        </tr>
    </table>
</body>
</html>
